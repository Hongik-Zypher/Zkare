# Zkare μλ£ κΈ°λ΅ κ΄€λ¦¬ μ‹μ¤ν…

## ν”„λ΅μ νΈ μ†κ°

Zkareλ” μ΄λ”λ¦¬μ›€ μ¤λ§νΈ μ»¨νΈλ™νΈ κΈ°λ°μ κ°„λ‹¨ν•κ³  μ•μ „ν• μλ£ κΈ°λ΅ κ΄€λ¦¬ μ‹μ¤ν…μ…λ‹λ‹¤.

- **μ¤λ§νΈμ»¨νΈλ™νΈ**: ν™μ μλ£ κΈ°λ΅μ μ•μ „ν• μ €μ¥/μ΅°ν/κ²€μ¦
- **ν”„λ΅ νΈμ—”λ“**: React κΈ°λ° UI, MetaMask μ—°λ™
- **κ°λ°ν™κ²½**: Hardhat(λ΅μ»¬ μ΄λ”λ¦¬μ›€), Cursor(μ½”λ“ AI), GitHub ν‘μ—…

## μ£Όμ” νΉμ§•

### κΈ°λ³Έ κΈ°λ¥
- β… **μ™„μ „ν• νƒμ¤‘μ•™ν™”**: λ°±μ—”λ“ μ„λ²„ μ—†μ΄ ν”„λ΅ νΈμ—”λ“μ—μ„ μ¤λ§νΈ μ»¨νΈλ™νΈμ™€ μ§μ ‘ ν†µμ‹ 
- β… **κ¶ν• κΈ°λ° μ ‘κ·Όμ μ–΄**: μμ‚¬λ§ μλ£ κΈ°λ΅ μ¶”κ°€ κ°€λ¥
- β… **λ””μ§€ν„Έ μ„λ…**: ECDSA μ„λ…μΌλ΅ μλ£ κΈ°λ΅ λ¬΄κ²°μ„± λ³΄μ¥
- β… **ν¬λ…μ„±**: λ¨λ“  κ±°λκ°€ λΈ”λ΅μ²΄μΈμ— ν¬λ…ν•κ² κΈ°λ΅
- β… **κ°„λ‹¨ν• κµ¬μ΅°**: λ³µμ΅ν• μμ§€μ‹μ¦λ… μ—†μ΄ κΈ°λ³Έμ μΈ μλ£ κΈ°λ΅ κ΄€λ¦¬μ— μ§‘μ¤‘

### π” μƒλ΅μ΄ μ•”νΈν™” κΈ°λ¥ (v2.0)
- β… **RSA λΉ„λ€μΉ­ν‚¤ μ•”νΈν™”**: μμ‚¬μ™€ ν™μμ κ°λ³„ ν‚¤ μ μƒμ„± λ° κ΄€λ¦¬
- β… **μ΄μ¤‘ μ•”νΈν™” μ‹μ¤ν…**: AES λ€μΉ­ν‚¤λ΅ λ°μ΄ν„° μ•”νΈν™” + RSA κ³µκ°ν‚¤λ΅ λ€μΉ­ν‚¤ μ•”νΈν™”
- β… **ν™μ κΈ°λ³Έμ •λ³΄ μ•”νΈν™”**: μ΄λ¦„, ν‚¤, λΈλ¬΄κ², νμ•΅ν•, μ£Όλ―Όλ²νΈ λ“± λ―Όκ° μ •λ³΄ λ³΄νΈ
- β… **μ§„λ£κΈ°λ΅ μ•”νΈν™”**: μ¦μƒ, μ§„λ‹¨, μΉλ£, μ²λ°© λ“± λ¨λ“  μλ£ λ°μ΄ν„° μ•”νΈν™”
- β… **μ„ νƒμ  λ³µνΈν™”**: μμ‚¬μ™€ ν™μκ°€ κ°μμ κ°μΈν‚¤λ΅λ§ λ°μ΄ν„° λ³µνΈν™” κ°€λ¥
- β… **κ³µκ°ν‚¤ λ“±λ΅ μ‹μ¤ν…**: λΈ”λ΅μ²΄μΈμ— κ³µκ°ν‚¤ λ“±λ΅ λ° κ²€μ¦

---

## κ°λ° ν™κ²½ μ„Έν…

### 1. μμ΅΄μ„± μ„¤μΉ

```bash
npm install
cd frontend && npm install
```

### 2. ν™κ²½ λ³€μ μ„¤μ •

ν”„λ΅μ νΈ λ£¨νΈμ— `.env` νμΌμ„ μƒμ„±ν•κ³  μ•„λ μμ‹μ²λΌ μ‘μ„±ν•μ„Έμ”:

```
PRIVATE_KEY=0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
CONTRACT_ADDRESS=λ°°ν¬λ_μ»¨νΈλ™νΈ_μ£Όμ†_μ—¬κΈ°μ—_μ…λ ¥
RPC_URL=http://127.0.0.1:8545
```

- `PRIVATE_KEY`λ” ν•λ“ν–‡ κΈ°λ³Έ μ²« λ²μ§Έ κ³„μ •μ ν”„λΌμ΄λΉ—ν‚¤μ…λ‹λ‹¤.
- `CONTRACT_ADDRESS`λ” λ°°ν¬ ν›„ μ¶λ ¥λλ” MedicalRecord μ»¨νΈλ™νΈ μ£Όμ†λ¥Ό μ…λ ¥ν•μ„Έμ”.

### 3. ν•λ“ν–‡ λ…Έλ“ μ‹¤ν–‰ (λ΅μ»¬ μ΄λ”λ¦¬μ›€)

```bash
npx hardhat node
```

### 4-A. κΈ°λ³Έ μ‹μ¤ν… λ°°ν¬

```bash
npx hardhat run scripts/deploy.js --network localhost
```

- λ°°ν¬κ°€ μ™„λ£λλ©΄, μ½μ†”μ— MedicalRecord μ»¨νΈλ™νΈ μ£Όμ†κ°€ μ¶λ ¥λ©λ‹λ‹¤.
- μ΄ μ£Όμ†λ¥Ό `.env`μ™€ `frontend/src/utils/contracts.js`μ `MEDICAL_RECORD_ADDRESS`μ— μ…λ ¥ν•μ„Έμ”.

### 4-B. π” μ•”νΈν™”λ μλ£κΈ°λ΅ μ‹μ¤ν… λ°°ν¬

```bash
npx hardhat run scripts/deploy-encrypted.js --network localhost
```

- KeyRegistryμ™€ EncryptedMedicalRecord μ»¨νΈλ™νΈκ°€ λ°°ν¬λ©λ‹λ‹¤.
- λ°°ν¬ μ™„λ£ ν›„ μ¶λ ¥λλ” μ£Όμ†λ“¤μ„ `.env` νμΌμ— μ¶”κ°€ν•μ„Έμ”:
```bash
REACT_APP_KEY_REGISTRY_ADDRESS=0x...
REACT_APP_ENCRYPTED_MEDICAL_RECORD_ADDRESS=0x...
```

### 5. ν”„λ΅ νΈμ—”λ“ μ‹¤ν–‰

```bash
cd frontend
npm start
```

- λΈλΌμ°μ €μ—μ„ `http://localhost:3000` μ ‘μ†
- MetaMaskμ—μ„ ν•λ“ν–‡ λ„¤νΈμ›ν¬(`http://127.0.0.1:8545`) μ¶”κ°€ λ° μ²« λ²μ§Έ κ³„μ • import

---

## μ‹μ¤ν… κµ¬μ΅°

```
Zkare/
β”β”€β”€ contracts/           # μ¤λ§νΈμ»¨νΈλ™νΈ (Solidity)
β”‚   β”β”€β”€ MedicalRecord.sol          # κΈ°λ³Έ μλ£κΈ°λ΅ μ»¨νΈλ™νΈ
β”‚   β”β”€β”€ AccessControl.sol          # μ ‘κ·Όμ μ–΄ μ»¨νΈλ™νΈ
β”‚   β”β”€β”€ KeyRegistry.sol            # π” κ³µκ°ν‚¤ λ“±λ΅ κ΄€λ¦¬ μ»¨νΈλ™νΈ
β”‚   β””β”€β”€ EncryptedMedicalRecord.sol # π” μ•”νΈν™”λ μλ£κΈ°λ΅ μ»¨νΈλ™νΈ
β”β”€β”€ scripts/             # λ°°ν¬/μλ™ν™” μ¤ν¬λ¦½νΈ
β”‚   β”β”€β”€ deploy.js                  # κΈ°λ³Έ μ»¨νΈλ™νΈ λ°°ν¬
β”‚   β””β”€β”€ deploy-encrypted.js        # π” μ•”νΈν™” μ»¨νΈλ™νΈ λ°°ν¬
β”β”€β”€ frontend/            # React ν”„λ΅ νΈμ—”λ“
β”‚   β”β”€β”€ src/
β”‚   β”‚   β”β”€β”€ components/      # React μ»΄ν¬λ„νΈ
β”‚   β”‚   β”‚   β”β”€β”€ KeyGeneration.js       # π” ν‚¤ μƒμ„± μ»΄ν¬λ„νΈ
β”‚   β”‚   β”‚   β”β”€β”€ PatientLookup.js       # π” ν™μ μ΅°ν μ»΄ν¬λ„νΈ
β”‚   β”‚   β”‚   β”β”€β”€ MedicalRecordViewer.js # π” κΈ°λ΅ μ΅°ν μ»΄ν¬λ„νΈ
β”‚   β”‚   β”‚   β””β”€β”€ EncryptedMedical.css   # π” μ•”νΈν™” κΈ°λ¥ μ¤νƒ€μΌ
β”‚   β”‚   β”β”€β”€ pages/          # νμ΄μ§€ μ»΄ν¬λ„νΈ
β”‚   β”‚   β”‚   β”β”€β”€ Home.js              # κΈ°λ³Έ ν™νμ΄μ§€
β”‚   β”‚   β”‚   β””β”€β”€ EncryptedMedical.js  # π” μ•”νΈν™” μλ£κΈ°λ΅ νμ΄μ§€
β”‚   β”‚   β”β”€β”€ utils/          # μ ν‹Έλ¦¬ν‹° (μ»¨νΈλ™νΈ μ—°λ™)
β”‚   β”‚   β”‚   β”β”€β”€ contracts.js         # κΈ°λ³Έ μ»¨νΈλ™νΈ μ—°λ™
β”‚   β”‚   β”‚   β””β”€β”€ encryption.js        # π” μ•”νΈν™”/λ³µνΈν™” μ ν‹Έλ¦¬ν‹°
β”‚   β”‚   β””β”€β”€ abis/           # μ»¨νΈλ™νΈ ABI νμΌ
β”β”€β”€ artifacts/           # ν•λ“ν–‡ μ»΄νμΌ κ²°κ³Ό
β”β”€β”€ .env                 # ν™κ²½λ³€μ νμΌ (μ§μ ‘ μƒμ„±)
β””β”€β”€ README.md            # μ΄ λ¬Έμ„
```

---

## μ‚¬μ© λ°©λ²•

### κΈ°λ³Έ κΈ°λ¥ (/)
#### 1. μ§€κ°‘ μ—°κ²°
- μ›Ήμ‚¬μ΄νΈ μ ‘μ† ν›„ "MetaMask μ—°κ²°" λ²„νΌ ν΄λ¦­
- MetaMaskμ—μ„ κ³„μ • μ—°κ²° μΉμΈ

#### 2. μμ‚¬ κ¶ν• νλ“
- μ»¨νΈλ™νΈ Owner(λ°°ν¬μ)κ°€ μμ‚¬ μ£Όμ†λ¥Ό λ“±λ΅ν•΄μ•Ό ν•¨
- Owner κ³„μ •μΌλ΅ λ΅κ·ΈμΈ μ‹ "μμ‚¬ κ΄€λ¦¬" λ©”λ‰΄μ—μ„ μμ‚¬ μ¶”κ°€ κ°€λ¥

#### 3. μλ£ κΈ°λ΅ κ΄€λ¦¬
- **μμ‚¬ κ³„μ •**: 
  - ν™μ μ£Όμ† μ…λ ¥ ν›„ "μλ£ κΈ°λ΅ μ¶”κ°€" λ²„νΌμΌλ΅ μƒ κΈ°λ΅ μ¶”κ°€
  - μ§„λ‹¨, μ²λ°©, λ‚ μ§, λ©”λ¨ λ“± μ…λ ¥ κ°€λ¥
- **λ¨λ“  μ‚¬μ©μ**:
  - ν™μ μ£Όμ† μ…λ ¥ ν›„ "μ΅°ν" λ²„νΌμΌλ΅ ν•΄λ‹Ή ν™μμ λ¨λ“  μλ£ κΈ°λ΅ μ΅°ν

---

### π” μ•”νΈν™”λ μλ£κΈ°λ΅ μ‹μ¤ν… (/encrypted)

#### 1. ν‚¤ μƒμ„± λ° λ“±λ΅
- **RSA ν‚¤ μ μƒμ„±**: "ν‚¤ μƒμ„±" λ²„νΌμ„ ν΄λ¦­ν•μ—¬ 2048λΉ„νΈ RSA ν‚¤ μ μƒμ„±
- **μ‚¬μ©μ μ ν• μ„ νƒ**: ν™μ λλ” μμ‚¬ μ¤‘ μ„ νƒ
- **κ³µκ°ν‚¤ λ“±λ΅**: μƒμ„±λ κ³µκ°ν‚¤λ¥Ό λΈ”λ΅μ²΄μΈμ— λ“±λ΅
- **κ°μΈν‚¤ λ‹¤μ΄λ΅λ“**: μƒμ„±λ κ°μΈν‚¤λ¥Ό μ•μ „ν• κ³³μ— μ €μ¥ (β οΈ λ¶„μ‹¤ μ‹ λ³µκµ¬ λ¶κ°€λ¥)

#### 2. ν™μ μ΅°ν λ° μ§„λ£κΈ°λ΅ μ‘μ„± (μμ‚¬λ§ κ°€λ¥)
- **ν™μ μ£Όμ† μ…λ ¥**: μ§„λ£ν•  ν™μμ μ§€κ°‘ μ£Όμ† μ…λ ¥
- **ν™μ μƒνƒ ν™•μΈ**:
  - β κ³µκ°ν‚¤ λ―Έλ“±λ΅: "λ“±λ΅λμ§€ μ•μ•μµλ‹λ‹¤" μ•λ‚΄
  - π‘¤ μ‹ κ· ν™μ: κΈ°λ³Έμ •λ³΄ + μ§„λ£κΈ°λ΅ μ‘μ„±
  - π“‹ κΈ°μ΅΄ ν™μ: μ§„λ£κΈ°λ΅λ§ μ¶”κ°€
- **κΈ°λ³Έμ •λ³΄ μ…λ ¥** (μ‹ κ· ν™μ):
  - μ΄λ¦„, ν‚¤, λΈλ¬΄κ², νμ•΅ν•, μ£Όλ―Όλ²νΈ
- **μ§„λ£κΈ°λ΅ μ…λ ¥**:
  - μ¦μƒ, μ§„λ‹¨, μΉλ£, μ²λ°©, λ©”λ¨
- **μ•”νΈν™” μ €μ¥**: λ¨λ“  λ°μ΄ν„°κ°€ AES+RSA μ΄μ¤‘μ•”νΈν™”λμ–΄ μ €μ¥

#### 3. μ§„λ£κΈ°λ΅ μ΅°ν
- **κ°μΈν‚¤ μ—…λ΅λ“**: λ‹¤μ΄λ΅λ“λ°›μ€ κ°μΈν‚¤ νμΌ μ—…λ΅λ“
- **κΈ°λ΅ λ΅λ“**:
  - ν™μ: "λ‚΄ μ§„λ£κΈ°λ΅ λ΅λ“" λ²„νΌ ν΄λ¦­
  - μμ‚¬: ν™μ μ£Όμ† μ…λ ¥ ν›„ "ν™μ κΈ°λ΅ λ΅λ“" λ²„νΌ ν΄λ¦­
- **λ³µνΈν™”**: "λ¨λ“  κΈ°λ΅ λ³µνΈν™”" λλ” κ°λ³„ "μ΄ κΈ°λ΅ λ³µνΈν™”" λ²„νΌ ν΄λ¦­
- **μ΅°ν**: λ³µνΈν™”λ κΈ°λ³Έμ •λ³΄ λ° λ¨λ“  μ§„λ£κΈ°λ΅ ν™•μΈ

#### 4. λ³΄μ• νΉμ§•
- **μ΄μ¤‘ μ•”νΈν™”**: 
  1. μλ£ λ°μ΄ν„°λ¥Ό AES-256-GCMμΌλ΅ μ•”νΈν™”
  2. AES ν‚¤λ¥Ό μμ‚¬/ν™μ κ³µκ°ν‚¤λ΅ κ°κ° RSA μ•”νΈν™”
- **μ„ νƒμ  μ ‘κ·Ό**: μμ‚¬μ™€ ν™μλ§ κ°μμ κ°μΈν‚¤λ΅ λ³µνΈν™” κ°€λ¥
- **λ¬΄κ²°μ„± λ³΄μ¥**: λΈ”λ΅μ²΄μΈμ— μ•”νΈν™”λ λ°μ΄ν„°μ™€ λ©”νƒ€λ°μ΄ν„° μ €μ¥
- **κ°μΈμ •λ³΄ λ³΄νΈ**: μ£Όλ―Όλ²νΈλ” λ§μ¤ν‚Ή μ²λ¦¬ν•μ—¬ ν‘μ‹

---

## μ¤λ§νΈ μ»¨νΈλ™νΈ μ£Όμ” κΈ°λ¥

### MedicalRecord.sol
- `addDoctor(address)`: μμ‚¬ μ¶”κ°€ (Ownerλ§ κ°€λ¥)
- `removeDoctor(address)`: μμ‚¬ μ κ±° (Ownerλ§ κ°€λ¥)
- `isDoctor(address)`: μμ‚¬ μ—¬λ¶€ ν™•μΈ
- `addMedicalRecord(...)`: μλ£ κΈ°λ΅ μ¶”κ°€ (μμ‚¬λ§ κ°€λ¥)
- `getMedicalRecord(...)`: μλ£ κΈ°λ΅ μ΅°ν
- `getRecordCount(address)`: ν™μμ κΈ°λ΅ μ μ΅°ν

---

## νΈλ¬λΈ”μν…

### μΌλ°μ μΈ λ¬Έμ 
- **μ»¨νΈλ™νΈ μ£Όμ† μ¤λ¥**: `.env` νμΌκ³Ό `contracts.js`μ μ£Όμ†κ°€ μΌμΉν•λ”μ§€ ν™•μΈ
- **MetaMask λ„¤νΈμ›ν¬**: ν•λ“ν–‡ λ΅μ»¬ λ„¤νΈμ›ν¬(`http://127.0.0.1:8545`)μ— μ—°κ²°λμ–΄ μλ”μ§€ ν™•μΈ
- **μμ‚¬ κ¶ν• μ—†μ**: Owner κ³„μ •μΌλ΅ ν•΄λ‹Ή μ£Όμ†λ¥Ό μμ‚¬λ΅ λ“±λ΅ν–λ”μ§€ ν™•μΈ
- **Gas λ¶€μ΅±**: MetaMaskμ—μ„ μ¶©λ¶„ν• ETHκ°€ μλ”μ§€ ν™•μΈ

### κ°λ°μ λ„κµ¬ ν™μ©
- λΈλΌμ°μ € κ°λ°μ λ„κµ¬ μ½μ†”μ—μ„ μ—λ¬ λ©”μ‹μ§€ ν™•μΈ
- MetaMask ν™λ™ νƒ­μ—μ„ νΈλμ­μ… μƒνƒ ν™•μΈ
- Hardhat λ…Έλ“ ν„°λ―Έλ„μ—μ„ λΈ”λ΅μ²΄μΈ λ΅κ·Έ ν™•μΈ
